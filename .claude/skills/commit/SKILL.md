---
name: commit
description: ステージ済みの変更内容を分析し、日本語の Conventional Commits 形式でコミットメッセージを作成してコミットする。
allowed-tools: Bash, Read, Glob, Grep
argument-hint: [オプション: コミットメッセージの補足説明]
---

# コミットスキル

ステージ済みの変更を分析し、日本語でコミットメッセージを作成してコミットする。

## 手順

### Step 1: 変更内容の把握

以下の git コマンドを並列で実行して、コミット対象の変更を把握する。

1. `git status` で未追跡ファイル・ステージ済みファイルを確認する
2. `git diff --cached --stat` でステージ済みの変更サマリーを確認する
3. `git diff --cached` でステージ済みの差分詳細を確認する
4. `git log --oneline -5` で直近のコミットメッセージのスタイルを確認する

### Step 2: ステージされていない変更の確認

ステージされていない変更がある場合は、ユーザーに以下を確認する:

- そのファイルもコミットに含めるか
- 含める場合は `git add <ファイル名>` で個別にステージする（`git add .` は使わない）

### Step 3: コミットメッセージの作成

以下のルールに従ってコミットメッセージを作成する。

#### フォーマット

```
<emoji><type>: <日本語の要約（1行目）>

<本文（任意）: 変更の背景・理由を日本語で2〜3行>

Co-Authored-By: Claude Opus 4.6 <noreply@anthropic.com>
```

#### type の選び方

| type | 絵文字 | 使い分け |
|------|--------|----------|
| feat | ✨ | 新機能の追加・既存機能の拡張 |
| fix | 🐛 | バグ修正 |
| docs | 📝 | ドキュメントのみの変更 |
| refactor | ♻️ | リファクタリング（機能変更なし） |
| chore | 🔧 | ビルド設定・依存関係・CI など |
| style | 💄 | フォーマット修正（コードの意味に影響なし） |
| test | ✅ | テストの追加・修正 |

#### メッセージの書き方ルール

- 1行目（要約）は日本語で簡潔に書く
- 1行目は「何をしたか」を書く（例: 「✨feat: Bedrock AgentCore の CDK サンプルを追加」）
- 本文は「なぜその変更をしたか」を書く
- 本文では箇条書き（`-`）を使って変更点を列挙する
- `.env`、認証情報、シークレットを含むファイルはコミットしない
- ユーザーから `$ARGUMENTS` で補足説明があればメッセージに反映する

### Step 4: コミットの実行

1. HEREDOC 形式でコミットメッセージを渡してコミットする

```bash
git commit -m "$(cat <<'EOF'
<コミットメッセージ>

Co-Authored-By: Claude Opus 4.6 <noreply@anthropic.com>
EOF
)"
```

2. コミット後に `git status` で成功を確認する
3. pre-commit フックで失敗した場合は、問題を修正して新しいコミットを作成する（`--amend` は使わない）

## コミットしない場合

- ステージ済みの変更がない場合はコミットせず、ユーザーに報告する
- `.env` や認証情報ファイルがステージされている場合は警告してコミットしない

## 禁止事項

- `git push` は実行しない（ユーザーが明示的に指示した場合のみ）
- `--amend` は使わない
- `--no-verify` は使わない
- `git add .` や `git add -A` は使わない
- git config の変更は行わない
